{"ast":null,"code":"import _regeneratorRuntime from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/maximuss/news/news/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/maximuss/news/news/client/src/container/Login.js\";\nimport React, { Component } from 'react';\nimport LoginForm from '../components/LoginForm';\nimport { withRouter } from 'react-router-dom';\nimport { login } from '../utils/requests';\nimport { Authenticate } from '../utils/auth';\n\nvar Login =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Login, _Component);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n    _this.onSubmit =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _this.setState({\n                isLoading: true\n              });\n\n            case 3:\n              _context.next = 5;\n              return login({\n                email: _this.state.login,\n                password: _this.state.password\n              });\n\n            case 5:\n              response = _context.sent;\n\n              if (response.success) {\n                Authenticate(response.token);\n\n                _this.props.history.push('/');\n              } else {\n                _this.setState({\n                  error: 'Invalid login or password',\n                  isLoading: false\n                });\n\n                setTimeout(function () {\n                  return _this.setState({\n                    error: ''\n                  });\n                }, 2000);\n              }\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n\n              _this.setState({\n                error: _context.t0\n              });\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 9]]);\n    }));\n    _this.state = {\n      login: '',\n      password: '',\n      error: '',\n      isLoading: false\n    };\n    _this.onLoginChange = _this.onLoginChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onPasswordChange = _this.onPasswordChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onReset = _this.onReset.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"onLoginChange\",\n    value: function onLoginChange(e) {\n      this.setState({\n        login: e.target.value\n      });\n    }\n  }, {\n    key: \"onPasswordChange\",\n    value: function onPasswordChange(e) {\n      this.setState({\n        password: e.target.value\n      });\n    }\n  }, {\n    key: \"onReset\",\n    value: function onReset() {\n      this.setState({\n        password: '',\n        login: '',\n        isLoading: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(LoginForm, {\n        onSubmit: this.onSubmit,\n        onPasswordChange: this.onPasswordChange,\n        onLoginChange: this.onLoginChange,\n        onReset: this.onReset,\n        error: this.state.error,\n        login: this.state.login,\n        password: this.state.password,\n        isLoading: this.state.isLoading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport default withRouter(Login);","map":{"version":3,"sources":["/home/maximuss/news/news/client/src/container/Login.js"],"names":["React","Component","LoginForm","withRouter","login","Authenticate","Login","props","onSubmit","setState","isLoading","email","state","password","response","success","token","history","push","error","setTimeout","onLoginChange","bind","onPasswordChange","onReset","e","target","value"],"mappings":"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","sourcesContent":["import React,{Component} from 'react'\nimport LoginForm from '../components/LoginForm'\nimport {withRouter} from 'react-router-dom'\nimport {login} from '../utils/requests'\nimport {Authenticate} from '../utils/auth'\n\nclass Login extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      login : '',\n      password : '',\n      error : '',\n      isLoading : false\n    }\n    this.onLoginChange = this.onLoginChange.bind(this)\n    this.onPasswordChange = this.onPasswordChange.bind(this)\n    this.onReset = this.onReset.bind(this)\n  }\n\n  onLoginChange(e) {\n    this.setState({\n      login : e.target.value\n    })\n  }\n\n  onPasswordChange(e) {\n    this.setState({\n      password : e.target.value\n    })\n  }\n\n  onReset() {\n    this.setState({\n      password : '',\n      login : '',\n      isLoading : false\n    })\n  }\n\n  onSubmit = async()  => {\n    try {\n       await this.setState({\n         isLoading : true\n       })\n       const response = await login({\n         email : this.state.login,\n         password : this.state.password\n       })\n       if(response.success) {\n         Authenticate(response.token)\n         this.props.history.push('/')\n       }\n       else {\n         this.setState({\n           error : 'Invalid login or password',\n           isLoading : false\n         })\n         setTimeout(() => this.setState({\n           error : ''\n         }),2000)\n       }\n     }\n     catch (e) {\n       this.setState({\n         error : e\n       })\n     }\n  }\n\n\n  render () {\n    return (\n        <LoginForm onSubmit={this.onSubmit}\n                   onPasswordChange={this.onPasswordChange}\n                   onLoginChange={this.onLoginChange}\n                   onReset={this.onReset}\n                   error={this.state.error}\n                   login={this.state.login}\n                   password={this.state.password}\n                   isLoading={this.state.isLoading}/>\n    )\n  }\n}\n\nexport default withRouter(Login)"]},"metadata":{},"sourceType":"module"}